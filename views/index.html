<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CourseMaster â€“ Dashboard</title>
    <link rel="stylesheet" href="/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
<div class="container">
    <nav class="navbar glass">
    <span class="nav-logo">
      <i class="fas fa-graduation-cap"></i>
      CourseMaster
    </span>
        <div class="nav-links">
      <span id="userInfo" style="color: #666; margin-right: 20px;">
        <i class="fas fa-user-circle"></i> Loading...
      </span>
            <a href="/" class="active"><i class="fas fa-tachometer-alt"></i> Dashboard</a>
            <a href="/admin" style="display:none" id="adminLink"><i class="fas fa-user-shield"></i> Admin</a>
            <a href="#" id="logoutBtn"><i class="fas fa-sign-out-alt"></i> Logout</a>
        </div>
    </nav>

    <header class="admin-header">
        <div class="admin-header-content">
            <h1 class="logo">ðŸŽ“ CourseMaster Dashboard</h1>
            <p class="tagline">Complete CRUD Management System for Online Courses</p>
            <div class="stats">
                <div class="stat-card">
                    <i class="fas fa-book-open"></i>
                    <span class="stat-count" id="totalCourses">0</span>
                    <span class="stat-label">Total Courses</span>
                </div>
                <div class="stat-card">
                    <i class="fas fa-dollar-sign"></i>
                    <span class="stat-count" id="avgPrice">$0</span>
                    <span class="stat-label">Average Price</span>
                </div>
                <div class="stat-card">
                    <i class="fas fa-database"></i>
                    <span class="stat-count" id="totalValue">$0</span>
                    <span class="stat-label">Total Value</span>
                </div>
            </div>
        </div>
    </header>

    <main class="dashboard">
        <div class="crud-section glass">
            <div class="section-header">
                <h2><i class="fas fa-plus-circle"></i> Create New Course</h2>
            </div>
            <div class="form-card">
                <form id="createForm">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="title">Title *</label>
                            <input type="text" id="title" required>
                        </div>
                        <div class="form-group">
                            <label for="price">Price ($) *</label>
                            <input type="number" id="price" step="0.01" min="0" required>
                        </div>
                        <div class="form-group">
                            <label for="instructor">Instructor *</label>
                            <input type="text" id="instructor" required>
                        </div>
                        <div class="form-group">
                            <label for="category">Category *</label>
                            <input type="text" id="category" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="level">Level</label>
                            <select id="level">
                                <option value="Beginner">Beginner</option>
                                <option value="Intermediate">Intermediate</option>
                                <option value="Advanced">Advanced</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="duration">Duration</label>
                            <input type="text" id="duration" placeholder="e.g. 10 hours">
                        </div>
                        <div class="form-group">
                            <label for="language">Language</label>
                            <input type="text" id="language" value="English">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="description">Description</label>
                        <textarea id="description" rows="3"></textarea>
                    </div>
                    <div class="form-actions">
                        <button type="submit" class="btn btn-primary">Create Course</button>
                    </div>
                </form>
            </div>
        </div>

        <div class="crud-section glass">
            <div class="section-header">
                <h2><i class="fas fa-edit"></i> Update Course</h2>
            </div>
            <div class="form-card">
                <div class="form-group">
                    <label for="searchCourse"><i class="fas fa-search"></i> Search Course by ID</label>
                    <div style="display:flex; gap:10px;">
                        <input type="text" id="searchCourse" placeholder="Numeric ID or Mongo ObjectId">
                        <button id="searchBtn" class="btn btn-small btn-primary">Search</button>
                    </div>
                </div>
                <form id="updateForm" style="display:none; margin-top:20px;">
                    <input type="hidden" id="updateId">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="updateTitle">Title *</label>
                            <input type="text" id="updateTitle" required>
                        </div>
                        <div class="form-group">
                            <label for="updatePrice">Price *</label>
                            <input type="number" id="updatePrice" step="0.01" required>
                        </div>
                        <div class="form-group">
                            <label for="updateInstructor">Instructor</label>
                            <input type="text" id="updateInstructor">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="updateCategory">Category</label>
                            <input type="text" id="updateCategory">
                        </div>
                        <div class="form-group">
                            <label for="updateLevel">Level</label>
                            <select id="updateLevel">
                                <option value="Beginner">Beginner</option>
                                <option value="Intermediate">Intermediate</option>
                                <option value="Advanced">Advanced</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="updateDuration">Duration</label>
                            <input type="text" id="updateDuration">
                        </div>
                        <div class="form-group">
                            <label for="updateLanguage">Language</label>
                            <input type="text" id="updateLanguage">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="updateDescription">Description</label>
                        <textarea id="updateDescription" rows="3"></textarea>
                    </div>
                    <div class="form-actions">
                        <button type="submit" class="btn btn-warning">Update</button>
                        <button type="button" id="cancelUpdate" class="btn btn-secondary">Cancel</button>
                    </div>
                </form>
            </div>
        </div>

        <div class="courses-section glass">
            <div class="section-header">
                <h2><i class="fas fa-list-alt"></i> All Courses</h2>
                <div class="section-actions">
                    <div class="filter-options">
                        <select id="sortFilter">
                            <option value="">Sort By</option>
                            <option value="price:asc">Price â†‘</option>
                            <option value="price:desc">Price â†“</option>
                            <option value="createdAt:desc">Newest</option>
                        </select>
                        <input type="number" id="minPriceFilter" placeholder="Min $" style="width: 80px;">
                        <input type="number" id="maxPriceFilter" placeholder="Max $" style="width: 80px;">
                        <select id="pageSize" style="width: 110px;">
                            <option value="5">5 / page</option>
                            <option value="10" selected>10 / page</option>
                            <option value="20">20 / page</option>
                            <option value="50">50 / page</option>
                        </select>
                    </div>
                    <button id="refreshBtn" class="btn btn-small btn-primary"><i class="fas fa-redo"></i></button>
                    <button id="exportBtn" class="btn btn-small btn-secondary"><i class="fas fa-download"></i></button>
                </div>
            </div>

            <div style="display:flex; gap:10px; align-items:center; justify-content:flex-end; margin-bottom:12px; flex-wrap:wrap;">
                <span id="pageInfo" style="color:#666; font-size:0.9rem;">Page 1 / 1</span>
                <button id="prevPageBtn" class="btn btn-small btn-secondary">Prev</button>
                <button id="nextPageBtn" class="btn btn-small btn-secondary">Next</button>
            </div>

            <div class="table-container">
                <table class="courses-table">
                    <thead>
                    <tr>
                        <th>ID</th>
                        <th>TITLE</th>
                        <th>INSTRUCTOR</th>
                        <th>CATEGORY</th>
                        <th>LEVEL</th>
                        <th>PRICE</th>
                        <th>DATE</th>
                        <th>ACTIONS</th>
                    </tr>
                    </thead>
                    <tbody id="coursesTableBody"></tbody>
                </table>
            </div>
        </div>
    </main>

    <footer class="admin-footer">
        <p>Â© 2026 CourseMaster</p>
    </footer>
</div>
<script src="/app.js"></script>
<script>
    fetch('/api/me', { credentials: 'include' })
        .then(r => r.ok ? r.json() : null)
        .then(u => {
            const link = document.getElementById('adminLink');
            if (u && u.role === 'admin') link.style.display = '';
        })
        .catch(() => {});
</script>
</body>
</html>
